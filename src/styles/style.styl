// -----------------------------
// imports
// -----------------------------
global-reset()

@require '_variables'
@require '_mixins'

// -----------------------------
// globals
// -----------------------------

html
  font-size: 62.5%

body
  color: $base-font-color
  font-size: $base-font-size

a
  color: $base-font-color
  cursor: pointer
  transition: $transition-link

  &:hover
    color: $btn-color-none
    text-decoration: none

s
  opacity: 0.8

strong
  font-weight: bold

.fa
  margin-right: 0.3em

  &.fa-square-o
    padding-right: 1px

// -----------------------------
// header
// -----------------------------

header
  background-color: #333
  color: #fff
  padding: $form-fieldset-padding $form-fieldset-padding
  position: relative
  z-index: 8

  h1
    display: inline-block
    font-size: 2rem
    margin-right: 1.5em

  nav
    display: inline-block

    li
      display: inline-block
      margin-right: 1.5em

      a
        color: #fff

        .fa
          font-size: 1.1em


// -----------------------------
// form
// -----------------------------

#status-form
  background-color: $form-background-color
  padding-bottom: $form-fieldset-padding
  padding-left: ($form-fieldset-padding / 2)
  padding-top: @padding-bottom
  position: relative

  for _class in status narrowing names
    &.active-{_class}
      display: block

      [data-field={_class}]
        background-color: rgba(#fff, 0.3)

        &::after
          border-color: rgba(#fff, 0.3) transparent transparent transparent
          border-style: solid
          border-bottom-width: 0
          border-left-width: 6px
          border-right-width: @border-left-width
          border-top-width: 7px
          bottom: -(@border-top-width)
          content: ''
          left: 50%
          margin-left: -(@border-left-width)
          position: absolute

        & + .fieldset-item
          opacity: 1
          //transform: translateY(100%)
          z-index: 3

  h2
    color: #fff
    display: inline-block
    margin-left: ($form-fieldset-padding / 2)

    &::after
      content: '：'

  fieldset
    display: inline-block
    padding-bottom: 2px
    // margin-bottom: $form-item-padding * 2 + $form-fieldset-padding * 2 + 1em
    white-space: nowrap

  legend
    border-radius: $border-radius
    color: #fff
    margin: 0 ($form-fieldset-padding / 2)
    padding: ($form-fieldset-padding / 2)
    position: relative
    transition: $transition-form
    z-index: 5

    &:hover
      background-color: rgba(#fff, 0.2)
      cursor: pointer

    .fa
      margin-left: 0.5em
      margin-right: 0

  .fieldset-item
    background-color: rgba($form-background-color, 85%)  
    border-top: 1px dotted rgba(#fff, 0.3)
    bottom: 0
    box-sizing: border-box
    left: 0
    opacity: 0
    padding: $form-fieldset-padding $form-fieldset-padding
    position: absolute
    right: 0
    transition: $transition-form
    transform: translateY(100%)
    transform-origin: 50% 0%;
    z-index: 2

    &:first-child
      display: block

  .input-group
    margin-top: $form-fieldset-padding

    &:first-child
      margin-top: 0

  h3
    color: #fff
    display: inline-block
    margin-right: 1em

  label
    display: inline-block
    margin-right: 1px

    &:hover
      cursor: pointer

    &:first-of-type
      & > span
        border-bottom-left-radius: $border-radius
        border-top-left-radius: $border-radius

    &:last-of-type
      & > span
        border-bottom-right-radius: $border-radius
        border-top-right-radius: $border-radius

  input[type="checkbox"],
  input[type="radio"]
    display: none

    & + span
      background-color: $btn-color-off
      border-color: @background-color
      border-style: solid
      border-width: 1px
      box-sizing: border-box
      color: lighten($btn-color-on, 10%)
      display: block
      padding: $form-item-padding
      position: relative
      transition: $transition-form

      &:hover
        background-color: $btn-color-hover

        .fa
          color: $btn-color-on
          opacity: 0.2

      .fa
        bottom: 0
        display: block
        left: 0
        line-height: $form-item-padding * 2 + 1em
        margin-right: 0
        opacity: 0
        position: absolute
        right: 0
        text-align: center
        top: 0
        transition: $transition-form

        &::before
          font-size: 3rem

        & + span
          position: relative
          z-index: 2

    &:checked + span
      background-color: $btn-color-on
      border-color: @background-color
      color: #fff

      .fa
        color: #fff
        opacity: 0.3

  input[type="text"]
    background-color: $btn-color-off
    border: 1px solid @background-color
    border-radius: $border-radius
    font-size: $base-font-size
    line-height: 1em + $form-item-padding * 2
    outline: none
    padding: 0 $form-item-padding
    transition: $transition-form
    width: 400px

    &:focus
      background-color: $btn-color-hover

  button
    border-radius: $border-radius
    color: #fff
    font-size: $base-font-size
    line-height: 1
    margin-left: 0.5em
    outline: none
    padding: $form-item-padding
    transition: $transition-form

    &.btn-all
      background-color: $btn-color-all
      border: 1px solid @background-color

      &:hover
        background-color: lighten(@background-color, 10%)

    &.btn-none
      background-color: $btn-color-none
      border: 1px solid @background-color

      &:hover
        background-color: lighten(@background-color, 10%)

// -----------------------------
// graph base
// -----------------------------

#status-graph
  margin: 2em 1.5em 1.5em 3em
  position: relative
  white-space: nowrap

// -----------------------------
// graph body
// -----------------------------

#status-graph-box
  overflow: auto
  padding-left: 1em
  position: relative
  z-index: 2

  .status-graph-item
    display: inline-block
    font-size: 0
    position: relative
    transition: $transition-graph
    vertical-align: bottom

    for _num in 0...9
      &.bars-{_num}
        width: ($bar-width + $bar-margin * 2) * _num + $graph-item-margin * 2

    .status-bar-box
      height: $config.maxStatus * $height-scale
      margin: 0 auto
      text-align: center

      &::after
        content: ''
        display: inline-block
        height: 100%
        vertical-align: bottom

      .status-bar
        display: inline-block
        margin: 0 $bar-margin
        position: relative
        transform-origin: 50% 100%
        transition: $transition-bar
        vertical-align: bottom
        width: $bar-width

        for _name, _color in $status-color
          &.{_name}
            background-color: rgba(_color, 0.5)

            &:hover
              background-color: lighten(rgba(_color, 0.5), 20%)

            &[data-status]
              background-color: _color

              &:hover
                background-color: lighten(_color, 20%)

        &::after
          background-color: rgba(#000, .7)
          border-radius: 2px
          box-sizing: border-box
          color: #fff
          display: block
          font-size: 1.2rem
          line-height: 1.5
          margin-left: ($bar-width / 2)
          opacity: 0
          position: absolute
          top: -3em
          transition: $transition-label
          visibility: hidden
          white-space: pre
          width: 3em
          left: (@width / 2) * -1
          z-index: 1

        &:hover::after
          opacity: 1
          top: -3.5em
          visibility: visible

        for _class, _label in $config.labels.status
          &.{_class}
            &::after
              content: quote(_label)"\A？"

            &[data-status]::after
              content: quote(_label)"\A"attr(data-status)

    .status-info-box
      padding-bottom: 20px

      .info-name,
      .info-id,
      .info-total
        font-size: 1.2rem
        text-align: center
        padding-top: 7px

// -----------------------------
// background lines
// -----------------------------

#status-graph-back
  border-bottom: 1px solid $backline-color-main
  left: 0
  position: absolute
  right: 0
  top: 0
  vertical-align: bottom
  z-index: 1

  .graph-back
    border-top: 1px solid $backline-color-main
    box-sizing: border-box
    height: 5px * $height-scale
    line-height: 1
    position: relative
    width: 100%

    &:nth-child(even)
      border-top: 1px dotted $backline-color-sub

      &::before
        content: ''

    &::before
      content: attr(data-line)
      display: block
      font-size: 1rem
      position: absolute
      text-align: right
      top: -0.5em
      width: 3em
      left: (@width + 0.5em) * -1

// -----------------------------
// usage help
// -----------------------------

#status-help
  background-color: rgba(0,0,0,0.8)
  bottom: 0
  color: #fff
  left: 0
  position: absolute
  right: 0
  top: 0
  transition: $transition-help
  z-index: 10

  a
    color: #fff

    &:hover
      color: rgba(#fff, 0.5)

  .help-body
    bottom: 6em
    left: 50%
    line-height: 1.8
    margin-left: -350px
    overflow: auto
    position: absolute
    right: 0
    top: 2em
    transition: $transition-help
    width: -(@margin-left * 2)

    h2
      font-size: 2rem
      border-bottom: 1px solid rgba(#fff, 0.5)
      margin-bottom: 2em
      padding-bottom: 1.5em
      text-align: center

    h3
      border-left: 5px solid rgba(#fff, 0.5)
      border-bottom: 1px solid rgba(#fff, 0.5)
      font-size: 1.6rem
      margin-bottom: 1.5em
      margin-top: 2em
      padding-left: 0.8em

    h4
      border-bottom: 1px solid rgba(#fff, 0.5)
      margin-bottom: 1em
      margin-top: 1.5em

    ul
      margin-left: 1.5em

    li
      list-style-type: disc

  .help-close
    bottom: 2em
    left: 0
    line-height: 4em
    text-align: center
    position: absolute
    right: 0

    a
      font-size: 1.6rem

// -----------------------------
// animations
// -----------------------------

.status-bar-enter {
  transform: scale(1, 0)

  &.status-bar-enter-active {
    transform: scale(1, 1)
  }
}

.status-bar-leave {
  transform: scale(1, 1)

  &.status-bar-leave-active {
    transform: scale(1, 0)
  }
}

.status-graph-appear
  opacity: 0

  .status-bar
    transform: scale(1, 0)

  &.status-graph-appear-active
    opacity: 1

    .status-bar
      transform: scale(1, 0)

.status-graph-enter
  opacity: 0
  width: 0 !important

  .status-bar
    transform: scale(1, 0)

  &.status-graph-enter-active
    opacity: 1

    for _num in 0...9
      &.bars-{_num}
        width: ($bar-width + $bar-margin * 2) * _num + $graph-item-margin * 2 !important

    .status-bar
      transform: scale(1, 0)

.status-graph-leave
  opacity: 1

  for _num in 0...9
    &.bars-{_num}
      width: ($bar-width + $bar-margin * 2) * _num + $graph-item-margin * 2 !important

  &.status-graph-leave-active
    opacity: 0
    width: 0 !important

.status-help-enter
  opacity: 0

  .help-body
    transform: translateY(-2em)

  &.status-help-enter-active
    opacity: 1

    .help-body
      transform: translateY(0)

.status-help-leave
  opacity: 1

  &.status-help-leave-active
    opacity: 0
